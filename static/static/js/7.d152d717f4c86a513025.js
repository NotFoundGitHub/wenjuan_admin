webpackJsonp([7],{"1aJR":function(t,e){},"2uIA":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("gyMJ");var a={name:"addQuest",components:{renderBox:s("C7Lr")({name:"renderBox",props:["form"],render:function(t){var e=this;return t("div",{on:{},style:{},class:"render"},[t("div",{class:"header"},[t("div",{class:"title"},[this.form.required?t("span",{class:"require"},"(*)"):"",t("span",this.form.questIndex+1+". "+this.form.title)]),t(this.form.type,{class:"content",props:{type:this.form.kind&&"i-input"===this.form.type?this.form.kind:null}},this.form.children.list.map(function(s){var i=e.form.children.type;if(i)return t(i,{class:"item",props:{title:s.title,label:"i-option"!=i?s.label:null,value:"i-option"==i?s.label:null}},s.title)}))]),t("div",{})])},mounted:function(){},updated:function(){}},null,!1,function(t){s("1aJR")},"data-v-4f2592af",null).exports},props:{},data:function(){return{spinShow:!0,questList:[],typeList:[{value:"i-input",label:"输入框"},{value:"Rate",label:"评分"},{value:"radio-group",label:"单选框"},{value:"CheckboxGroup",label:"多选框"},{value:"i-select",label:"下拉选择"}]}},watch:{},computed:{},methods:{handleAdd:function(){this.questList.push({title:"输入题目",type:"",required:!1,kind:"",value:"",questIndex:"",children:{type:"",list:[{}]}})},handleSave:function(){var t=this,e=this.$route.query._id;i.a.addQuest({survey:e,data:this.questList}).then(function(e){1==e.status?t.$Message.success(e.msg):t.$Message.error(e.msg)}).catch(function(e){t.$Message.error("请求错误或网络错误")})},handleDelete:function(t,e){var s=this;i.a.delQuest({_id:e}).then(function(e){1==e.status?(s.$Message.success(e.msg),s.questList.splice(t,1)):s.$Message.error(e.msg)}).catch(function(t){s.$Message.error("请求错误或网络错误")})},handleTypeChange:function(t,e){var s=this.questList[e].children;switch(t){case"i-input":s.type="",s.list.splice(0);break;case"Rate":s.type="",this.questList[e].value=0,s.list.splice(0);break;case"radio-group":s.type="radio",s.list.splice(0);break;case"CheckboxGroup":s.type="checkbox",this.questList[e].value=[],s.list.splice(0);break;case"i-select":s.type="i-option",s.list.splice(0)}},addOption:function(t){var e=this.questList[t];if(e.type&&"i-input"!=e.type&&"Rate"!=e.type){var s=e.children.list.length;0==s||s>0&&e.children.list[s-1].label||e.children.list[s-1].title?e.children.list.push({title:"",label:""}):this.$Message.error("请先输入完整各个选项才可以增加")}else this.$Message.error("当前类型不支持多个选择，请重新选择")},delOption:function(t,e){var s=this.questList[e].children;this.$Message.warning("删除 "+s.list[t].title),s.list.splice(t,1)}},created:function(){},mounted:function(){var t=this,e=this.$route.query._id;i.a.getQuest({survey:e}).then(function(e){1==e.status?(t.$Message.success(e.msg),t.questList=e.data,t.spinShow=!1):(t.$Message.error(e.msg),t.spinShow=!1)}).catch(function(e){t.$Message.error("请求错误或网络错误"),t.spinShow=!1})}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"addQuest"},[s("div",{staticClass:"header"},[s("Button",{attrs:{type:"success",shape:"circle",icon:"md-cloud-done"},on:{click:t.handleSave}},[t._v("保存所有")])],1),t._v(" "),t.questList.length?t._l(t.questList,function(e,i){return s("Card",{key:"card"+t._uid+i,staticClass:"card",attrs:{bordered:!0,flag:e.questIndex=i,index:i}},[s("div",{staticClass:"title",attrs:{slot:"title"},slot:"title"},[s("label",{staticClass:"label"},[t._v("题目"+t._s(i+1)+":")]),t._v(" "),s("Input",{attrs:{placeholder:"输入题目",clearable:""},model:{value:e.title,callback:function(s){t.$set(e,"title",s)},expression:"card.title"}}),t._v(" "),s("span",{staticClass:"delBtn",on:{click:function(s){return t.handleDelete(i,e._id)}}},[t._v("x")])],1),t._v(" "),s("div",{staticClass:"body"},[s("div",{staticClass:"setting"},[s("div",{staticClass:"item"},[s("label",{staticClass:"label"},[t._v("类型:")]),t._v(" "),s("Select",{staticStyle:{width:"200px"},attrs:{clearable:""},on:{"on-change":function(s){return t.handleTypeChange(e.type,i)}},model:{value:e.type,callback:function(s){t.$set(e,"type",s)},expression:"card.type"}},t._l(t.typeList,function(e){return s("Option",{key:"type"+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1),t._v(" "),"i-input"==e.type?s("span",[s("Select",{staticStyle:{width:"100px"},attrs:{clearable:""},model:{value:e.kind,callback:function(s){t.$set(e,"kind",s)},expression:"card.kind"}},[s("Option",{attrs:{value:"text"}},[t._v("单行文本框")]),t._v(" "),s("Option",{attrs:{value:"textarea"}},[t._v("多行文本框")])],1)],1):t._e()],1),t._v(" "),s("div",{staticClass:"item"},[s("label",{staticClass:"label"},[t._v("是否必填:")]),t._v(" "),s("i-switch",{model:{value:e.required,callback:function(s){t.$set(e,"required",s)},expression:"card.required"}})],1),t._v(" "),s("div",{staticClass:"item"},[s("Button",{attrs:{type:"primary"},on:{click:function(e){return t.addOption(i)}}},[s("Icon",{attrs:{type:"md-add"}}),t._v("增加选项\n            ")],1)],1)]),t._v(" "),e.type&&"i-input"!==e.type&&"Rate"!=e.type?s("div",{staticClass:"options"},t._l(e.children.list,function(a,l){return s("div",{key:"op"+t._uid+i+l,staticClass:"item"},[s("div",{staticClass:"op"},[s("label",{staticClass:"label"},[t._v("选项:")]),t._v(" "),s("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"如..北京",clearable:""},model:{value:a.title,callback:function(e){t.$set(a,"title",e)},expression:"item.title"}})],1),t._v(" "),s("div",{staticClass:"op"},[s("label",{staticClass:"label"},[t._v("对应值:")]),t._v(" "),"i-select"===e.type?s("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"如..beijing",clearable:""},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"item.value"}}):s("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"如..beijing1",clearable:""},model:{value:a.label,callback:function(e){t.$set(a,"label",e)},expression:"item.label"}})],1),t._v(" "),s("div",{staticClass:"op"},[s("Button",{attrs:{type:"error"},on:{click:function(e){return t.delOption(l,i)}}},[s("Icon",{attrs:{type:"md-close-circle"}}),t._v("删除\n              ")],1)],1)])}),0):t._e()]),t._v(" "),s("Divider",[t._v("渲染结果")]),t._v(" "),s("render-box",{attrs:{form:e}})],1)}):t._e(),t._v(" "),t.spinShow?s("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),s("Button",{attrs:{type:"primary",shape:"circle",icon:"md-add-circle"},on:{click:t.handleAdd}},[t._v("增加题目")]),t._v(" "),s("BackTop")],2)},staticRenderFns:[]};var n=s("C7Lr")(a,l,!1,function(t){s("FFdh")},"data-v-1b57cf84",null);e.default=n.exports},FFdh:function(t,e){}});
//# sourceMappingURL=7.d152d717f4c86a513025.js.map